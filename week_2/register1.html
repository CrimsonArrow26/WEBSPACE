<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="register1.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Libre+Franklin:ital,wght@0,100..900;1,100..900&family=Rethink+Sans:ital,wght@0,400..800;1,400..800&family=Satisfy&family=Secular+One&display=swap"
      rel="stylesheet"
    />
    <script src="register1.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js"></script>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
      import { getAuth, signInWithPopup, GoogleAuthProvider, FacebookAuthProvider } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";
      import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js";

      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyCDHjGnKQhw4Q33pHSuHCfvzABI5-Ft7Jg",
        authDomain: "nivaran-9bc6b.firebaseapp.com",
        projectId: "nivaran-9bc6b",
        storageBucket: "nivaran-9bc6b.appspot.com",
        messagingSenderId: "431802679807",
        appId: "1:431802679807:web:8fcaa4016379c8a99ae7ca",
        measurementId: "G-1PX9CJV5GV"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      // Google login provider
      const providerGoogle = new GoogleAuthProvider();

      // Facebook login provider
      const providerFacebook = new FacebookAuthProvider();

      // Sign-in with Google function
      document.querySelector('.secondary').addEventListener('click', () => {
        signInWithPopup(auth, providerGoogle)
          .then(result => {
            const user = result.user;
            console.log("Google Login Success:", user);
            saveUserData(user);
          })
          .catch(err => console.error(err));
      });

      // Sign-in with Facebook function
      document.querySelector('.tertiary').addEventListener('click', () => {
        signInWithPopup(auth, providerFacebook)
          .then(result => {
            const user = result.user;
            console.log("Facebook Login Success:", user);
            saveUserData(user);
          })
          .catch(err => console.error(err));
      });

      // Save user data to Firestore
      function saveUserData(user) {
        const userRef = doc(db, "users", user.uid);
        setDoc(userRef, {
          name: user.displayName,
          email: user.email,
          photo: user.photoURL
        }).then(() => {
          console.log("User data saved to Firestore");
        }).catch((error) => {
          console.error("Error saving user data:", error);
        });
      }

      // Handle the authentication state
      auth.onAuthStateChanged(user => {
        if (user) {
          // Display user information on the page
          document.getElementById("welcome").innerText = "Welcome, " + user.displayName;
          document.getElementById("profile-pic").src = user.photoURL;
        }
      });
    </script>

    <title>Document</title>
  </head>
  <body>
    <div class="container">
      <img class="background-image" src="resources/elements/Frame.png" />
      <img class="background-image" src="resources/elements/Frame.png" />
      <img class="background-image1" src="resources/elements/frame1.png" />
      <div class="overlay"></div>
      <div class="content">
        <div class="buttons">
          <button  class="primary">
            <img src="resources/elements/apple.png" alt="icon" class="icon" />
            Sign up with Apple
          </button>
          <button id="google-signup" class="secondary">
            <img src="resources/elements/google.png" alt="icon" class="icon" />
            Sign up with Google
          </button>
          <button id="facebook-signup" class="tertiary">
            <img
              src="resources/elements/facebook.png"
              alt="icon"
              class="icon"
            />
            Sign up with Facebook
          </button>
          <p>or</p>
          <a href="register2.html">
            <button class="quaternary">Sign up with E-mail</button>
          </a>
        </div>
        <div class="terms">
          By registering, you agree to our Terms of Use. Learn how we collect,
          use and share your data.
        </div>
      </div>
    </div>
    <h2 id="welcome"></h2>
<img id="profile-pic" style="width:80px; border-radius:50%;">
  </body>
</html>
